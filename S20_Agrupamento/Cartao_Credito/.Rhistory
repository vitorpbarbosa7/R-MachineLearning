base = read.csv('original.csv')
setwd('C:\\Users\\Vitor Barbosa\\Google Drive\\DS\\Udemy-R\\S20_Agrupamento\\Cartao_Credito')
base = read.csv('original.csv')
#Função apply para somar as colunas linha por linha (MARGIN=1)
base$BILL_AMTT = apply(base[,13:18],1,sum)
#Agrupamento neste caso em uma base bidimensional apenas
X = data.frame(limite = base$LIMIT_BAL,
gasto = base$BILL_AMTT,
genero = base$SEX,
educacao = base$EDUCATION,
civil = base$MARRIAGE,
idade = base$AGE)
X_scale = as.data.frame(scale(X))
set.seed(1)
wcss = vector()
for (i in 1:10) {
kmeans = kmeans(x = X_scale, centers = i)
wcss[i] = sum(kmeans$withinss)
}
#Visualização do wcss
plot(wcss)
# KMeans ------------------------------------------------------------------
set.seed(1)
kmeans = kmeans(x = X_scale,
centers = 6)
previsoes = kmeans$cluster
pcacorr = prcomp(X, scale = T)
View(pcacorr)
coordenadas = pcacorr$x
View(coordenadas)
clusplot(coordenadas[,c(1,2)], previsoes, color = T)
coordenadas = as.data.frame(pcacorr$x)
#Clustplot não dá muito certo assim não
library(cluster)
clusplot(coordenadas[,c(1,2)], previsoes, color = T)
plot(coordenadas[,c(1,2)],
col = previsoes)
plot(X[,c(1,2)],
color = previsoes)
View(X)
plot(X[,c(1,2)],
col = previsoes)
# KMeans ------------------------------------------------------------------
set.seed(1)
kmeans = kmeans(x = X_scale,
centers = 4)
previsoes = kmeans$cluster
pairs(X, col = c(1:4)[previsoes])
